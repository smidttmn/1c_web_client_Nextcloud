# one_c_web_client - –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
- –¢–µ—Å—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä: cloud.smidt.keenetic.pro (Nextcloud 32.0.5)
- 1–° —Å–µ—Ä–≤–µ—Ä—ã: 10.72.1.5 (HTTPS, —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç)
- –ë–∞–∑—ã: sgtbuh, zupnew

## –ü–ª–∞–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
üì¶ –ë–æ–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä: Nextcloud 31 –≤–µ—Ä—Å–∏–∏
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —É–ø–∞–∫–æ–≤–∞–Ω–æ –≤ –∞—Ä—Ö–∏–≤
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ occ app:install
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –¥–ª—è –±–æ–µ–≤—ã—Ö 1–° —Å–µ—Ä–≤–µ—Ä–æ–≤

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Nextcloud 31
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ API —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å NC 31:
- OCP\AppFramework\Http\ContentSecurityPolicy
- OCP\AppFramework\Http\TemplateResponse
- OCP\Util::addScript()
- OCP\IConfig

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–æ–µ–≤–æ–º—É —Å–µ—Ä–≤–µ—Ä—É
1. **HTTPS –Ω–∞ 1–° —Å–µ—Ä–≤–µ—Ä–∞—Ö** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
   - –ï—Å–ª–∏ –Ω–µ—Ç HTTPS - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–∫—Å–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
   - –õ–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Nginx Proxy Manager

2. **CSP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
   - –î–æ–±–∞–≤–∏—Ç—å –¥–æ–º–µ–Ω—ã 1–° –≤ PageController.php
   - `$csp->addAllowedFrameDomain('https://1c.example.com')`

3. **trusted_domains**
   - –î–æ–±–∞–≤–∏—Ç—å –¥–æ–º–µ–Ω –±–æ–µ–≤–æ–≥–æ Nextcloud
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å 1–° –∏–∑ —Å–µ—Ç–∏ Nextcloud

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–∞ –±–æ–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ Nextcloud
sudo -u www-data php -f /path/to/nextcloud/occ status

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ 1–°
curl -kI https://10.72.1.5/sgtbuh/
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
sudo cp -r one_c_web_client /path/to/nextcloud/apps/
sudo chown -R www-data:www-data /path/to/nextcloud/apps/one_c_web_client

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ occ
sudo -u www-data php occ app:install one_c_web_client

# –í–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
sudo -u www-data php occ app:enable one_c_web_client
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí 1C WebClient
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CSP (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `/apps/one_c_web_client/lib/Controller/PageController.php`:
```php
$csp->addAllowedFrameDomain('https://1c.boevoy-server.ru');
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
1. **–°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã** - –±—Ä–∞—É–∑–µ—Ä –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç
   - –†–µ—à–µ–Ω–∏–µ: –ø—Ä–∏–Ω—è—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
   
2. **Mixed Content** - –µ—Å–ª–∏ 1–° —Ç–æ–ª—å–∫–æ –ø–æ HTTP
   - –†–µ—à–µ–Ω–∏–µ: –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS –Ω–∞ 1–° –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏

3. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å NC 31** - API –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å
   - –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Nextcloud

## –ö–æ–Ω—Ç–∞–∫—Ç—ã
–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: Nextcloud Team
–î–∞—Ç–∞: –§–µ–≤—Ä–∞–ª—å 2026
–í–µ—Ä—Å–∏—è: 1.0.0
