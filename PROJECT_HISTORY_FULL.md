# one_c_web_client - –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞

## üìÖ –•—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –§–µ–≤—Ä–∞–ª—å 2026 - –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### –î–µ–Ω—å 1: –ù–∞—á–∞–ª–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ 1–° —Å Nextcloud
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
  - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ø–∏—Å–∫–∞ –±–∞–∑ 1–°
  - –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å —Å –∫–Ω–æ–ø–∫–∞–º–∏ –±–∞–∑
  - –û—Ç–∫—Ä—ã—Ç–∏–µ 1–° –≤–æ —Ñ—Ä–µ–π–º–µ –≤–Ω—É—Ç—Ä–∏ Nextcloud
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–±–æ—Ç—ã –∏–∑ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏

#### –î–µ–Ω—å 2-3: –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º CSP
**–ü—Ä–æ–±–ª–µ–º–∞:** Content Security Policy –±–ª–æ–∫–∏—Ä—É–µ—Ç inline —Å–∫—Ä–∏–ø—Ç—ã

**–†–µ—à–µ–Ω–∏–µ:**
- –í—ã–Ω–µ—Å–µ–Ω JavaScript –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª `js/index.js`
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `Util::addScript()`
- –î–æ–±–∞–≤–ª–µ–Ω nonce —á–µ—Ä–µ–∑ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä Nextcloud

#### –î–µ–Ω—å 4-5: –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã Mixed Content
**–ü—Ä–æ–±–ª–µ–º–∞:** Nextcloud —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ HTTPS, 1–° —Ç–æ–ª—å–∫–æ –ø–æ HTTP

**–ü–æ–ø—ã—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏—è:**
1. ‚ùå Apache ProxyPass - Nextcloud –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ .htaccess
2. ‚ùå –û—Ç–¥–µ–ª—å–Ω—ã–π VirtualHost –Ω–∞ –ø–æ—Ä—Ç—É 8443 - SSL –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. ‚ùå mod_rewrite —Å –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º - .htaccess –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç
4. ‚úÖ **–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** HTTPS –Ω–∞ 1–° —Å–µ—Ä–≤–µ—Ä–∞—Ö (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)

#### –î–µ–Ω—å 6: –§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –ù–∞—Å—Ç—Ä–æ–µ–Ω CSP –¥–ª—è HTTPS 1–° —Å–µ—Ä–≤–µ—Ä–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Nextcloud 31-32
- –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Nextcloud     ‚îÇ
‚îÇ   (HTTPS)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ HTTPS
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   1C Server     ‚îÇ
‚îÇ   (HTTPS)       ‚îÇ
‚îÇ   10.72.1.5     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **PageController.php**
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CSP
   - –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —à–∞–±–ª–æ–Ω–æ–≤

2. **admin_settings.php**
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –±–∞–∑
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

3. **index.php (–∫–ª–∏–µ–Ω—Ç)**
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –±–∞–∑
   - –û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ—Ä–µ–π–º–∞
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

4. **index.js**
   - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
   - –û—Ç–∫—Ä—ã—Ç–∏–µ –±–∞–∑ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### CSP –ù–∞—Å—Ç—Ä–æ–π–∫–∏

```php
$csp = new ContentSecurityPolicy();
$csp->addAllowedFrameDomain('http://10.72.1.5');
$csp->addAllowedFrameDomain('https://10.72.1.5');
$csp->addAllowedFrameDomain('https://cloud.smidt.keenetic.pro');
$response->setContentSecurityPolicy($csp);
```

## üöß –ü—Ä–µ–æ–¥–æ–ª–µ–Ω–Ω—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏

### 1. CSP –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
**–°–∏–º–ø—Ç–æ–º:** `Executing inline script violates Content Security Policy`

**–†–µ—à–µ–Ω–∏–µ:**
- –í—ã–Ω–æ—Å JS –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Util::addScript()`
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ nonce

### 2. Mixed Content
**–°–∏–º–ø—Ç–æ–º:** `The page was loaded over HTTPS, but requested an insecure frame`

**–ü–æ–ø—ã—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏—è:**
- Apache ProxyPass ‚ùå
- Separate VirtualHost ‚ùå
- mod_rewrite ‚ùå
- **HTTPS –Ω–∞ 1–° ‚úÖ**

### 3. Nextcloud .htaccess
**–°–∏–º–ø—Ç–æ–º:** ProxyPass –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, Nextcloud –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã

**–ü—Ä–∏—á–∏–Ω–∞:** `AllowOverride All` –≤ –∫–æ–Ω—Ñ–∏–≥–µ Nextcloud

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä—è–º–æ–µ HTTPS –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ 1–°

### 4. –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
**–°–∏–º–ø—Ç–æ–º:** –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–∏–Ω—è—Ç–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **–§–∞–π–ª–æ–≤:** 120+
- **–†–∞–∑–º–µ—Ä:** 112 KB
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~3000
- **–í–µ—Ä—Å–∏—è:** 1.0.0
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** Nextcloud 31-32

## üéØ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏

‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑ 1–°
‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å —Å –∫–Ω–æ–ø–∫–∞–º–∏
‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ 1–° –≤–æ —Ñ—Ä–µ–π–º–µ
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HTTPS
‚úÖ CSP –∑–∞—â–∏—Ç–∞
‚úÖ –†–∞–±–æ—Ç–∞ –∏–∑ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏
‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Nextcloud 31-32
‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìù –£—Ä–æ–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ
- –ü—Ä—è–º–æ–µ HTTPS –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ 1–°
- CSP —á–µ—Ä–µ–∑ PageController
- Util::addScript() –¥–ª—è JS
- –®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä Nextcloud

### –ß—Ç–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ
- Apache ProxyPass —Å .htaccess
- Separate VirtualHost –¥–ª—è –ø—Ä–æ–∫—Å–∏
- mod_rewrite –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS –Ω–∞ 1–°
2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å CSP –∑–∞—Ä–∞–Ω–µ–µ
3. –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å API
4. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ä–µ—à–µ–Ω–∏—è

## üîÑ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –í–æ–∑–º–æ–∂–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ 1–°
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π 1–°
- [ ] –í–µ–±—Å–æ–∫–µ—Ç—ã –¥–ª—è real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- [ ] –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ—Ä–µ–π–º–æ–≤
- [ ] –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑
- [ ] –°–∂–∞—Ç–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- [ ] CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** Nextcloud Team  
**–î–∞—Ç–∞:** –§–µ–≤—Ä–∞–ª—å 2026  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–õ–∏—Ü–µ–Ω–∑–∏—è:** AGPL v3

## üìö –†–µ—Å—É—Ä—Å—ã

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Nextcloud](https://docs.nextcloud.com/)
- [CSP Spec](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)
- [1C Web Interface](https://users.v8.1c.ru/)

---

**–ö–æ–Ω–µ—Ü –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞** üéâ
